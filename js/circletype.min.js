/*
 * CircleType 0.36
 * Peter Hrynkow
 * Copyright 2014, Licensed GPL & MIT
 *
*/
$.fn.circleType=function(t){var e={dir:1,position:"relative",links:!1};return"function"!=typeof $.fn.lettering?void console.log("Lettering.js is required"):this.each(function(){t&&$.extend(e,t);var i,n,r=this,o=180/Math.PI,s=parseInt($(r).css("font-size"),10),f=parseInt($(r).css("line-height"),10)||s,a=r.innerHTML.replace(/^\s+|\s+$/g,"").replace(/\s/g,"&nbsp;");r.innerHTML=a,$(r).lettering(),r.style.position=e.position,i=r.getElementsByTagName("span"),n=Math.floor(i.length/2);var l=function(){var n,l,h,p,d,g,u,m,T=0,y=0;for(n=0;n<i.length;n++)T+=i[n].offsetWidth;for(l=T/Math.PI/2+f,e.fluid&&!e.fitText?e.radius=Math.max(r.offsetWidth/2,l):e.radius||(e.radius=l),h=-1===e.dir?"center "+(-e.radius+f)/s+"em":"center "+e.radius/s+"em",p=e.radius-f,n=0;n<i.length;n++)d=i[n],y+=d.offsetWidth/2/p*o,d.rot=y,y+=d.offsetWidth/2/p*o;var b=new Array,v=new Array;if(t.links){var w=a.split("<a&nbsp");w.shift(),w.forEach(function(t){var e=t.substring(7,t.indexOf("<")).split(">");b.push(e[1].replace(/&nbsp;/g," ")),v.push(e[0].substring(0,e[0].length-1))})}var M=0,x=0,O=!1;for(n=0;n<i.length;n++)d=i[n],g=d.style,u=-y*e.dir/2+d.rot*e.dir,m="rotate("+u+"deg)",g.position="absolute",g.left="50%",g.marginLeft=-(d.offsetWidth/2)/s+"em",g.webkitTransform=m,g.MozTransform=m,g.OTransform=m,g.msTransform=m,g.transform=m,g.webkitTransformOrigin=h,g.MozTransformOrigin=h,g.OTransformOrigin=h,g.msTransformOrigin=h,g.transformOrigin=h,-1===e.dir&&(g.bottom=0),b[M].charAt(x)==d.innerHTML||"&nbsp;"==d.innerHTML&&" "==b[M].charAt(x)?(d.innerHTML="<a href='"+v[M]+"'>"+d.innerHTML+"</a>",x++,O=!0):O&&(M++,x=0,O=!1);e.fitText&&("function"!=typeof $.fn.fitText?console.log("FitText.js is required when using the fitText option"):($(r).fitText(),$(window).resize(function(){c()}))),c(),"function"==typeof e.callback&&e.callback.apply(r)},h=function(t){var e=document.documentElement,i=t.getBoundingClientRect();return{top:i.top+window.pageYOffset-e.clientTop,left:i.left+window.pageXOffset-e.clientLeft,height:i.height}},c=function(){var t,e=h(i[n]),o=h(i[0]);t=e.top<o.top?o.top-e.top+o.height:e.top-o.top+o.height,r.style.height=t+"px"};e.fluid&&!e.fitText&&$(window).resize(function(){l()}),"complete"!==document.readyState?(r.style.visibility="hidden",$(window).load(function(){r.style.visibility="visible",l()})):l()})};
